---
phase: 11-details-review
plan: 02
type: execute
wave: 2
depends_on: ["11-01"]
files_modified:
  - web/src/components/analysis/SeverityBadge.tsx
  - web/src/components/analysis/FindingCard.tsx
  - web/src/components/analysis/FindingsList.tsx
  - web/src/components/analysis/index.ts
  - web/src/pages/AnalysisDetailsPage.tsx
autonomous: true

must_haves:
  truths:
    - "User sees list of findings grouped or sorted by severity"
    - "User sees severity badge for each finding (critical/major/minor/info)"
    - "User can expand finding to see evidence details"
    - "User can see remediation suggestion when available"
  artifacts:
    - path: "web/src/components/analysis/FindingsList.tsx"
      provides: "List of findings with grouping/sorting"
      min_lines: 30
    - path: "web/src/components/analysis/FindingCard.tsx"
      provides: "Expandable finding card with evidence"
      min_lines: 40
    - path: "web/src/components/analysis/SeverityBadge.tsx"
      provides: "Color-coded severity badge"
      min_lines: 15
  key_links:
    - from: "AnalysisDetailsPage.tsx"
      to: "FindingsList"
      via: "Component import and render"
      pattern: "<FindingsList"
    - from: "FindingsList.tsx"
      to: "FindingCard"
      via: "Map over findings"
      pattern: "findings\\.map"
---

<objective>
Create findings display components with severity badges and expandable details.

Purpose: Allow engineers to review all validation findings with evidence before making approve/reject decisions.
Output: FindingsList, FindingCard, SeverityBadge components integrated into AnalysisDetailsPage.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/milestones/v2.0-ROADMAP.md
@.planning/STATE.md

# Prior work
@.planning/phases/11-details-review/11-01-SUMMARY.md

# Existing code
@web/src/types/analysis.ts
@web/src/components/analysis/StatusBadge.tsx
@web/src/components/analysis/VerdictBadge.tsx
@web/src/pages/AnalysisDetailsPage.tsx
@web/src/components/ui/card.tsx
@web/src/components/ui/badge.tsx

# Backend schema reference
@app/api/schemas.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SeverityBadge and FindingCard components</name>
  <files>web/src/components/analysis/SeverityBadge.tsx, web/src/components/analysis/FindingCard.tsx</files>
  <action>
    1. Create SeverityBadge.tsx:
       - Props: severity ('critical' | 'major' | 'minor' | 'info')
       - Color mapping:
         - critical: red/destructive
         - major: orange/amber
         - minor: yellow
         - info: blue/slate
       - Use shadcn Badge with appropriate variant
       - Capitalize first letter of severity for display

    2. Create FindingCard.tsx:
       - Props: finding (FindingDetail type from types/analysis.ts)
       - Collapsible card using shadcn Card
       - Header row (always visible):
         - SeverityBadge
         - rule_id (monospace/code style)
         - message (main text)
         - Expand/collapse chevron icon
       - Expanded content (when open):
         - Evidence section (if evidence exists):
           - Extracted value: {evidence.extracted_value}
           - Threshold: {evidence.threshold}
           - Standard: {evidence.standard_reference}
         - Remediation section (if remediation exists):
           - Icon + remediation text
       - Use useState for expanded state
       - Smooth transition for expand/collapse
       - Default collapsed, click to expand
  </action>
  <verify>cd web && npx tsc --noEmit</verify>
  <done>SeverityBadge shows colored severity, FindingCard expands to show evidence/remediation</done>
</task>

<task type="auto">
  <name>Task 2: Create FindingsList and integrate into AnalysisDetailsPage</name>
  <files>web/src/components/analysis/FindingsList.tsx, web/src/components/analysis/index.ts, web/src/pages/AnalysisDetailsPage.tsx</files>
  <action>
    1. Create FindingsList.tsx:
       - Props: findings (FindingDetail[])
       - Group findings by severity (critical first, then major, minor, info)
       - For each group:
         - Section header with severity name and count
         - List of FindingCard components
       - Empty state when no findings:
         - "No issues found" message with success icon
       - Summary at top: "X findings (Y critical, Z major)"

    2. Update index.ts:
       - Export SeverityBadge, FindingCard, FindingsList

    3. Integrate into AnalysisDetailsPage.tsx:
       - Replace findings placeholder with FindingsList component
       - Pass analysis.findings to FindingsList
       - Position in the right column or below verdict/confidence section
       - Add section heading "Findings" or "Validation Results"
  </action>
  <verify>cd web && npm run build</verify>
  <done>FindingsList displays all findings grouped by severity, integrated into details page</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd web && npm run build` succeeds without errors
- [ ] SeverityBadge displays correct colors for each severity level
- [ ] FindingCard shows rule_id, message, severity
- [ ] FindingCard expands to show evidence and remediation
- [ ] FindingsList groups findings by severity (critical first)
- [ ] FindingsList shows count summary
- [ ] Empty state shown when no findings
- [ ] Findings section visible on AnalysisDetailsPage
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Findings display with proper severity indicators
- Evidence and remediation visible when expanded
</success_criteria>

<output>
After completion, create `.planning/phases/11-details-review/11-02-SUMMARY.md`
</output>
