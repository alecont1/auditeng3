---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [pyproject.toml, app/__init__.py, app/config.py, app/schemas/__init__.py, app/schemas/base.py, app/schemas/user.py, app/schemas/task.py, app/schemas/analysis.py, app/schemas/finding.py]
autonomous: true

must_haves:
  truths:
    - "Project dependencies are installable with pip/uv"
    - "Pydantic models validate sample data correctly"
    - "All schema models are importable from app.schemas"
  artifacts:
    - path: "pyproject.toml"
      provides: "Project configuration with dependencies"
      contains: "fastapi"
    - path: "app/schemas/user.py"
      provides: "User schema with email validation"
      min_lines: 20
    - path: "app/schemas/analysis.py"
      provides: "Analysis schema with status enum"
      min_lines: 30
    - path: "app/schemas/finding.py"
      provides: "Finding schema with severity enum"
      min_lines: 25
  key_links:
    - from: "app/schemas/__init__.py"
      to: "app/schemas/*.py"
      via: "re-exports all schemas"
      pattern: "from.*import"
---

<objective>
Create the project foundation with proper Python packaging and Pydantic v2 schemas for all core domain models.

Purpose: Establish the schema layer that defines the shape of all data in the system. These Pydantic models serve as the source of truth for validation and serialization.

Output: Working Python project with installable dependencies and complete schema definitions for User, Task, Analysis, and Finding.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/research/SUMMARY.md

Requirements this plan addresses:
- DATA-01: System stores analysis results in PostgreSQL (schema layer)
- DATA-04: System stores user and authentication data (User schema)
- DATA-05: System stores document metadata (Analysis schema)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create project structure and pyproject.toml</name>
  <files>pyproject.toml, app/__init__.py</files>
  <action>
Create the project root with pyproject.toml using modern Python packaging.

Dependencies to include (from research SUMMARY.md):
- fastapi[standard]>=0.115.0
- uvicorn[standard]>=0.32.0
- pydantic>=2.10.0
- pydantic-settings>=2.6.0
- sqlalchemy[asyncio]>=2.0.36
- asyncpg>=0.29.0
- alembic>=1.14.0
- instructor>=1.7.0
- anthropic>=0.40.0
- redis>=5.2.0
- dramatiq[redis]>=1.17.0
- python-jose[cryptography]>=3.3.0
- passlib[bcrypt]>=1.7.4
- python-multipart>=0.0.9
- httpx>=0.28.0
- tenacity>=9.0.0

Dev dependencies:
- pytest>=8.0.0
- pytest-asyncio>=0.24.0
- pytest-cov>=5.0.0

Set Python version >=3.11.
Create app/__init__.py with version string.
  </action>
  <verify>pip install -e . succeeds (or uv pip install -e .)</verify>
  <done>Project is installable with all dependencies</done>
</task>

<task type="auto">
  <name>Task 2: Create base Pydantic schemas and enums</name>
  <files>app/schemas/__init__.py, app/schemas/base.py, app/schemas/enums.py</files>
  <action>
Create the schema foundation with Pydantic v2 patterns.

app/schemas/base.py:
- BaseSchema with model_config using from_attributes=True
- TimestampMixin with created_at, updated_at as datetime fields
- IDMixin with id as UUID

app/schemas/enums.py - define all enums:
- TaskStatus: QUEUED, PROCESSING, COMPLETED, FAILED
- AnalysisVerdict: APPROVED, REVIEW, REJECTED
- FindingSeverity: CRITICAL, MAJOR, MINOR, INFO
- EquipmentType: PANEL, UPS, ATS, GEN, XFMR
- TestType: GROUNDING, MEGGER, THERMOGRAPHY

Use StrEnum from enum for string serialization.
  </action>
  <verify>python -c "from app.schemas.base import BaseSchema; from app.schemas.enums import TaskStatus"</verify>
  <done>Base schemas and enums importable and functional</done>
</task>

<task type="auto">
  <name>Task 3: Create domain Pydantic schemas</name>
  <files>app/schemas/user.py, app/schemas/task.py, app/schemas/analysis.py, app/schemas/finding.py</files>
  <action>
Create Pydantic v2 schemas for all domain models.

app/schemas/user.py:
- UserBase: email (EmailStr), is_active (bool, default True)
- UserCreate: extends UserBase, adds password (str, min 8 chars)
- UserInDB: extends UserBase + IDMixin + TimestampMixin, adds hashed_password
- User: extends UserBase + IDMixin + TimestampMixin (for API responses, no password)

app/schemas/task.py:
- TaskBase: status (TaskStatus), original_filename (str), file_size (int)
- TaskCreate: extends TaskBase, adds user_id (UUID)
- Task: extends TaskBase + IDMixin + TimestampMixin, adds user_id, analysis_id (optional)

app/schemas/analysis.py:
- AnalysisBase: equipment_type (EquipmentType), test_type (TestType), equipment_tag (str optional)
- ExtractionResult: raw_data (dict), confidence_scores (dict[str, float]), extraction_errors (list[str])
- ValidationResult: is_valid (bool), compliance_score (float 0-100), findings_count (int)
- Analysis: extends AnalysisBase + IDMixin + TimestampMixin, adds:
  - task_id (UUID)
  - verdict (AnalysisVerdict)
  - compliance_score (float)
  - confidence_score (float)
  - extraction_result (ExtractionResult optional)
  - validation_result (ValidationResult optional)

app/schemas/finding.py:
- FindingBase: severity (FindingSeverity), rule_id (str), message (str)
- FindingEvidence: extracted_value (Any), threshold (Any), standard_reference (str)
- Finding: extends FindingBase + IDMixin, adds:
  - analysis_id (UUID)
  - evidence (FindingEvidence optional)
  - remediation (str optional)

Update app/schemas/__init__.py to re-export all schemas.
  </action>
  <verify>python -c "from app.schemas import User, Task, Analysis, Finding, TaskStatus, FindingSeverity"</verify>
  <done>All domain schemas importable with proper validation</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] pip install -e . succeeds
- [ ] All schemas import without error
- [ ] Pydantic validation works (test with sample data)
- [ ] Enums serialize to strings correctly
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No type errors or import errors
- Schemas follow Pydantic v2 best practices
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
