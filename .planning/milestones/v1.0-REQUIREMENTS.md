# Requirements Archive: v1.0 MVP

**Archived:** 2026-01-16
**Status:** ✅ SHIPPED

This is the archived requirements specification for v1.0.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

# Requirements: AuditEng

**Defined:** 2026-01-15
**Core Value:** "IA extrai, código valida" — AI extraction + deterministic validation ensures reproducibility, explainability, and traceability of every finding.

## v1 Requirements

Requirements for initial release. Each maps to roadmap phases.

### Document Upload & Processing (UPLD)

- [x] **UPLD-01**: User can upload PDF files up to 50MB
- [x] **UPLD-02**: User can upload image files (PNG, JPG, TIFF) for thermal images
- [x] **UPLD-03**: System queues uploaded documents for background processing
- [x] **UPLD-04**: User can view processing status of uploaded documents
- [x] **UPLD-05**: System stores original documents for reprocessing capability
- [x] **UPLD-06**: System handles multi-page PDF documents with page-level processing

### AI Extraction (EXTR)

- [x] **EXTR-01**: System extracts structured data from Grounding test reports
- [x] **EXTR-02**: System extracts structured data from Megger (insulation resistance) test reports
- [x] **EXTR-03**: System extracts structured data from Thermography inspection reports
- [x] **EXTR-04**: System extracts equipment identification (TAG, serial number, type)
- [x] **EXTR-05**: System extracts test measurements with units
- [x] **EXTR-06**: System extracts calibration certificate information (expiration, traceability)
- [x] **EXTR-07**: System assigns confidence score (0-1) to each extracted field
- [x] **EXTR-08**: System flags low-confidence extractions for human review
- [x] **EXTR-09**: System retries extraction on validation failure (max 3 attempts)
- [x] **EXTR-10**: System processes thermal images using Claude Vision

### Validation Engine (VALD)

- [x] **VALD-01**: System validates grounding resistance against NETA/IEEE thresholds
- [x] **VALD-02**: System validates insulation resistance against IEEE 43 standards
- [x] **VALD-03**: System validates thermography temperature deltas against severity thresholds
- [x] **VALD-04**: System validates calibration certificate expiration dates
- [x] **VALD-05**: System performs cross-field validation (equipment TAG consistency)
- [x] **VALD-06**: System validates measurement units are present and consistent
- [x] **VALD-07**: Validation produces identical results for identical inputs (deterministic)
- [x] **VALD-08**: Validation rules are externalized in configuration (not hard-coded)
- [x] **VALD-09**: System validates against equipment-type-specific thresholds (PANEL, UPS, ATS, GEN, XFMR)

### RAG Pipeline (RAG) — DEFERRED

- [ ] **RAG-01**: System indexes technical standards documents (NETA, IEEE, Microsoft CxPOR)
- [ ] **RAG-02**: System chunks standards using semantic boundaries (256-512 tokens)
- [ ] **RAG-03**: System embeds chunks using text-embedding-3-small
- [ ] **RAG-04**: System stores embeddings in pgvector (PostgreSQL)
- [ ] **RAG-05**: System retrieves relevant standard sections during validation
- [ ] **RAG-06**: System supports hybrid search (vector + keyword)

*Note: RAG requirements deferred — standards are finite and hard-coded thresholds with references suffice for v1.*

### Findings & Verdicts (FIND)

- [x] **FIND-01**: System generates findings with severity levels (CRITICAL, MAJOR, MINOR, INFO)
- [x] **FIND-02**: System assigns severity based on validation rule violations
- [x] **FIND-03**: System computes compliance score (0-100%)
- [x] **FIND-04**: System computes confidence score based on extraction quality
- [x] **FIND-05**: System determines verdict: APPROVED (no CRITICAL, score >= 95%)
- [x] **FIND-06**: System determines verdict: REVIEW (score 80-94% or low confidence)
- [x] **FIND-07**: System determines verdict: REJECTED (any CRITICAL finding)
- [x] **FIND-08**: Each finding includes evidence (extracted value, threshold, standard reference)
- [x] **FIND-09**: Findings include remediation guidance

### API & Integration (API)

- [x] **API-01**: System provides REST API for document submission
- [x] **API-02**: System provides REST API for analysis status polling
- [x] **API-03**: System provides REST API for retrieving analysis results
- [x] **API-04**: API requires authentication (JWT tokens)
- [x] **API-05**: API includes rate limiting (10 requests/minute per user)
- [x] **API-06**: API returns structured JSON responses with proper error codes
- [x] **API-07**: API documentation available via OpenAPI/Swagger

### Reporting (REPT)

- [x] **REPT-01**: System generates PDF report with findings summary
- [x] **REPT-02**: Report includes equipment identification and test metadata
- [x] **REPT-03**: Report includes detailed findings with severity indicators
- [x] **REPT-04**: Report includes compliance score and verdict
- [x] **REPT-05**: Report includes standard references for each finding
- [x] **REPT-06**: User can download PDF report via API

### Audit Trail (AUDT)

- [x] **AUDT-01**: System logs all extraction attempts with timestamps
- [x] **AUDT-02**: System logs all validation decisions with rule IDs
- [x] **AUDT-03**: System logs model version and prompt version used
- [x] **AUDT-04**: System logs confidence scores for each extraction
- [x] **AUDT-05**: Audit logs are immutable (append-only)
- [x] **AUDT-06**: User can retrieve audit trail for any analysis

### Background Processing (PROC)

- [x] **PROC-01**: System uses Dramatiq for reliable job queue processing
- [x] **PROC-02**: Jobs retry on failure with exponential backoff
- [x] **PROC-03**: System supports job prioritization
- [x] **PROC-04**: System provides job status tracking
- [x] **PROC-05**: System handles graceful degradation on partial failures

### Data Models (DATA)

- [x] **DATA-01**: System stores analysis results in PostgreSQL
- [x] **DATA-02**: System uses SQLAlchemy 2.0 with async support
- [x] **DATA-03**: System uses Alembic for database migrations
- [x] **DATA-04**: System stores user and authentication data
- [x] **DATA-05**: System stores document metadata and storage references

## Out of Scope

Explicitly excluded. Documented to prevent scope creep.

| Feature | Reason |
|---------|--------|
| Mobile app nativo | Focus on web/API first per PROJECT.md |
| Integração com Procore/externos | MVP standalone per PROJECT.md |
| Geração automática de relatórios PDF completos | Basic PDF only for MVP, full reports deferred |
| Multi-idioma | English only for MVP per PROJECT.md |
| Frontend web completo | API-first approach, basic UI only |
| Real-time WebSocket updates | Polling sufficient for MVP |
| Video processing | Not relevant to commissioning reports |
| Blockchain audit trails | Standard DB audit sufficient for MVP |
| Federated learning | Single-tenant model sufficient for v1 |
| OAuth/SSO login | JWT authentication sufficient for MVP |

---

## Milestone Summary

**Shipped:** 55 of 61 v1 requirements (90%)
**Adjusted:** RAG requirements (RAG-01 through RAG-06) deferred — standards are finite, hard-coded thresholds with references suffice
**Dropped:** None

---
*Archived: 2026-01-16 as part of v1.0 milestone completion*
